{"version":3,"sources":["webpack:///./src/3d/005-particles/particles.vue?d325","webpack:///./src/3d/005-particles/particles.vue?d8b7","webpack:///./src/3d/dist/005-particles/logic/Logic.js","webpack:///./src/3d/dist/005-particles/logic/Stage.js","webpack:///src/3d/005-particles/particles.vue","webpack:///./src/3d/005-particles/particles.vue?9762","webpack:///./src/3d/005-particles/particles.vue"],"names":["plane","material","render","_vm","this","_h","$createElement","_self","_c","_m","staticRenderFns","staticClass","attrs","_v","THREE","window","that","Stage","container","runFlag","initFlag","meshObjects","scene","Scene","name","fog","Fog","containerEle","document","querySelector","renderer","WebGLRenderer","antialias","alpha","precision","setClearColor","setPixelRatio","devicePixelRatio","setSize","clientWidth","clientHeight","appendChild","domElement","initCamera","initLight","addEventListener","handleResize","initStats","vpW","vpH","width","height","camera","aspect","updateProjectionMatrix","spotLight","SpotLight","position","set","z","add","PerspectiveCamera","innerWidth","innerHeight","y","lookAt","Vector3","control","OrbitControls","autoRotate","enabled","objcet","children","forEach","data","Mesh","length","uuid","push","findMesh","Stats","stats","style","left","top","animateId","requestAnimationFrame","run","update","loopCB","cancelAnimationFrame","TweenMax","Logic","audio","planeDefinition","planeSize","totalObjects","PlaneGeometry","MeshBasicMaterial","color","wireframe","rotation","x","Math","PI","geometry","Geometry","i","vertex","random","vertices","scrite","TextureLoader","load","PointsMaterial","size","map","transparent","setHSL","particles","Points","verticesNeedUpdate","stage","rigister","degree","getAverageFrequency","loop","addStageObjects","speed","time","Date","now","vertexHeight","to","h","props","computed","playing","mounted","watch","type","handler","v","deep","component"],"mappings":"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","file":"chunk-4c1d68d0.1.0.0.1576739062686.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./particles.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./particles.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"particles\"},[_c('div',{attrs:{\"id\":\"canvasFather\"}}),_c('div',{staticClass:\"name\"},[_vm._v(\" 粒粒可见 \")])])}]\n\nexport { render, staticRenderFns }","import Stage from './Stage';\nimport audio from '../../PlayerAudio/PlayerAudio';\nconst THREE = window.THREE;\nconst TweenMax = window.TweenMax;\nlet plane;\nlet material;\nclass Logic {\n    constructor() {\n        this.audio = audio;\n    }\n    addStageObjects() {\n        // 增加平面\n        var planeDefinition = 100;\n        var planeSize = 1245000;\n        var totalObjects = 100000;\n        plane = new THREE.Mesh(new THREE.PlaneGeometry(planeSize, planeSize, planeDefinition, planeDefinition), new THREE.MeshBasicMaterial({ color: 0x555555, wireframe: true }));\n        plane.name = \"plane\";\n        plane.rotation.x = -Math.PI * .5;\n        // this.scene.add( plane );\n        //增加粒子\n        var totalObjects = 100000;\n        var geometry = new THREE.Geometry();\n        for (let i = 0; i < totalObjects; i++) {\n            var vertex = new THREE.Vector3();\n            vertex.x = Math.random() * planeSize - (planeSize * .5);\n            vertex.y = Math.random() * 50000 - 5000 * 0.5;\n            vertex.z = Math.random() * planeSize - (planeSize * .5);\n            geometry.vertices.push(vertex);\n        }\n        var scrite = new THREE.TextureLoader().load('static/textures/disc.png');\n        material = new THREE.PointsMaterial({ size: 2000, map: scrite, transparent: true });\n        material.color.setHSL(1.0, 0.3, 0.7);\n        var particles = new THREE.Points(geometry, material);\n        particles.geometry.verticesNeedUpdate = true;\n        particles.name = 'particles';\n        this.stage.scene.add(particles);\n    }\n    initStage() {\n        this.stage = new Stage(\"#canvasFather\");\n        this.stage.rigister(() => {\n            let degree = audio.getAverageFrequency();\n            this.loop(degree * 2);\n        });\n        this.addStageObjects();\n    }\n    loop(speed) {\n        var time = Date.now() * 0.00005;\n        var vertexHeight = 20000;\n        // let plane = this.object.plane\n        for (var i = 0; i < plane.geometry.vertices.length; i++) {\n            plane.geometry.vertices[i].z += Math.random() * vertexHeight - vertexHeight;\n        }\n        this.stage.camera.position.z -= speed; // 150\n        if (this.stage.camera.position.z < 100000) {\n            TweenMax.to(this.stage.camera.position, 0, { z: 550000 });\n        }\n        var h = (360 * (1.0 + time) % 360) / 360;\n        material.color.setHSL(h, 0.5, 0.5);\n        this.stage.camera.lookAt(this.stage.scene.position);\n    }\n}\nexport default new Logic();\n","// import { dao } from './model'\n// import { EventContent } from './Moumade'\n// import StageUvProcess from './StageUvProcess'\nconst THREE = window.THREE;\nlet that = null;\nexport default class Stage {\n    constructor(container) {\n        this.container = container;\n        this.runFlag = false;\n        this.initFlag = false;\n        // 场景里所有的mesh对象\n        this.meshObjects = [];\n        that = this;\n        // 场景\n        this.scene = new THREE.Scene();\n        window.scene = this.scene;\n        this.scene.name = \"moumade\";\n        this.scene.fog = new THREE.Fog(0x000000, 1, 300000);\n        // 渲染器\n        this.containerEle = document.querySelector(container);\n        this.renderer = new THREE.WebGLRenderer({\n            antialias: true,\n            alpha: true,\n            precision: 'highp'\n        });\n        this.renderer.setClearColor(0x000000, 0.0);\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setSize(this.containerEle.clientWidth, this.containerEle.clientHeight);\n        this.containerEle.appendChild(this.renderer.domElement);\n        this.initCamera();\n        this.initLight();\n        window.addEventListener(\"resize\", this.handleResize);\n        this.handleResize();\n        // this.initControl()\n        this.initStats();\n    }\n    handleResize() {\n        // 获取新的大小\n        let vpW = that.containerEle.clientWidth;\n        let vpH = that.containerEle.clientHeight;\n        // 设置场景\n        that.renderer.domElement.width = vpW;\n        that.renderer.domElement.height = vpH;\n        that.renderer.setSize(that.containerEle.clientWidth, that.containerEle.clientHeight);\n        // 设置相机\n        that.camera.aspect = vpW / vpH;\n        that.camera.updateProjectionMatrix();\n    }\n    initLight() {\n        var spotLight = new THREE.SpotLight(0xffffff);\n        spotLight.position.set(0, 10000, this.camera.position.z + 4000);\n        spotLight.name = \"spotLight\";\n        this.scene.add(spotLight);\n    }\n    initCamera() {\n        this.camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 400000);\n        this.camera.position.z = 550000;\n        this.camera.position.y = 10000;\n        this.camera.lookAt(new THREE.Vector3(0, 6000, 0));\n        this.scene.add(this.camera);\n        this.camera.name = \"camera\";\n    }\n    initControl() {\n        this.control = new THREE.OrbitControls(this.camera, this.renderer.domElement);\n        this.control.autoRotate = false;\n        this.control.enabled = true;\n    }\n    findMesh(objcet) {\n        if (objcet.children) {\n            objcet.children.forEach((data) => {\n                if (data instanceof THREE.Mesh) {\n                    if (this.meshObjects.length == 0 || this.meshObjects[this.meshObjects.length - 1].uuid != data.uuid) {\n                        this.meshObjects.push(data);\n                    }\n                }\n                this.findMesh(data);\n            });\n        }\n    }\n    initStats() {\n        const Stats = window.Stats;\n        this.stats = new Stats(); // 创建一个性能监视器\n        this.stats.domElement.style.position = 'absolute'; // 样式， 坐标\n        this.stats.domElement.style.left = '0px';\n        this.stats.domElement.style.top = '0px';\n        document.querySelector(this.container).appendChild(this.stats.domElement);\n    }\n    run() {\n        that.animateId = requestAnimationFrame(that.run);\n        that.renderer.render(that.scene, that.camera);\n        // that.control.update()\n        that.stats.update();\n        that.loopCB && that.loopCB();\n    }\n    stop() {\n        cancelAnimationFrame(this.animateId);\n    }\n    rigister(loopCB) {\n        this.loopCB = loopCB;\n    }\n    resize() {\n        this.handleResize();\n    }\n}\n","<template>\n  <div class=\"particles\">\n    <div id=\"canvasFather\"></div>\n    <div class=\"name\">\n      粒粒可见\n    </div>\n  </div>\n</template>\n\n<script>\nimport logic from \"../dist/005-particles/logic/Logic\";\n\nlet that = null;\n\nexport default {\n  props: [\"type\"],\n  computed: {\n    playing() {\n      return logic.audio.subject.playing;\n    }\n  },\n  mounted() {\n    logic.initStage();\n  },\n  watch: {\n    type: {\n      handler: function(v) {\n        if (v == \"min\") {\n          logic.stage.resize();\n          if (logic.audio.subject.playing) {\n            logic.stage.run();\n          } else {\n            logic.stage.stop();\n          }\n        } else {\n          logic.stage.stop();\n        }\n      }\n    },\n    playing: {\n      handler: function(v) {\n        if (v) {\n          logic.stage.run();\n        } else {\n          logic.stage.stop();\n        }\n      },\n      deep: true\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n.name {\n  position: absolute;\n  bottom: 40px;\n  left: 30px;\n  font-size: 20px;\n  color: #ddd;\n}\n.particles {\n  width: 100%;\n  height: 100%;\n  #canvasFather {\n    width: 100%;\n    height: 100%;\n\n    background-color: #000;\n    background-image: radial-gradient(\n      ellipse farthest-corner at center top,\n      #003466 0%,\n      #000000 80%\n    );\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./particles.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./particles.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./particles.vue?vue&type=template&id=b76641c4&\"\nimport script from \"./particles.vue?vue&type=script&lang=js&\"\nexport * from \"./particles.vue?vue&type=script&lang=js&\"\nimport style0 from \"./particles.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}